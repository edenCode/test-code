ui_print("start......");
open_led();
set_progress("1");
show_progress("1","90");
ui_print("update fastboot......");
ifelse(getprop("persist.sys.packagetype.qfp") == "true", package_extract_file("fastboot-qfp.img", "/dev/block/platform/soc/by-name/fastboot"),
        package_extract_file("fastboot.img", "/dev/block/platform/soc/by-name/fastboot"));
ui_print("update bootargs......");
package_extract_file("bootargs.img", "/dev/block/platform/soc/by-name/bootargs");
ui_print("update recovery......");
package_extract_file("recovery.img", "/dev/block/platform/soc/by-name/recovery");
ui_print("update baseparam......");
package_extract_file("baseparam.img", "/dev/block/platform/soc/by-name/baseparam");
ui_print("update logo......");
package_extract_file("logo.img", "/dev/block/platform/soc/by-name/logo");
ui_print("update fastplay......");
format("raw", "EMMC", "/dev/block/platform/soc/by-name/fastplay", "0", "fastplay");
package_extract_file("fastplay.img", "/dev/block/platform/soc/by-name/fastplay");
ui_print("update boot.....");
package_extract_file("boot.img", "/dev/block/platform/soc/by-name/kernel");
ui_print("update pq_param.....");
package_extract_file("pq_param.img", "/dev/block/platform/soc/by-name/pqparam");
ui_print("update userapi.....");
package_extract_file("userapi.img", "/dev/block/platform/soc/by-name/userapi");
ui_print("update hibdrv.....");
package_extract_file("hibdrv.img", "/dev/block/platform/soc/by-name/hibdrv");
ui_print("update system......");
format("raw", "EMMC", "/dev/block/platform/soc/by-name/qbflag", "0", "qbflag");
format("ext4", "EMMC", "/dev/block/platform/soc/by-name/system", "0", "/system");
mount("ext4", "EMMC", "/dev/block/platform/soc/by-name/system", "/system");
package_extract_dir("system", "/system");
set_perm_recursive(0, 2000, 0755, 0755, "/system/bin");
set_perm_recursive(0, 2000, 0755, 0755, "/system/xbin");
set_perm_recursive(0, 2000, 0755, 0755, "/system/etc");
ui_print("clear otapackage......");
format("ext4", "EMMC", "/dev/block/platform/soc/by-name/otapackage", "0", "/otapackage");
mount("ext4", "EMMC", "/dev/block/platform/soc/by-name/otapackage", "/otapackage");
ui_print("clear otapackage over......");